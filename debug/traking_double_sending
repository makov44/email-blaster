select t1._count, t1.res_id, t2.email  from (SELECT t0.res_id , count(*) as _count
	FROM public.mail_mail_statistics as t0
    group by t0.res_id
    having count(*) >1) as t1
    left join public.mail_mass_mailing_contact as t2 on t1.res_id = t2.id
    order by t1._count desc;


SELECT *   FROM public.mail_mass_mailing_contact
WHERE id IN (SELECT id
              FROM (SELECT id,
                             ROW_NUMBER() OVER (partition BY email ORDER BY id ) AS rnum
                     FROM public.mail_mass_mailing_contact) t
              WHERE t.rnum > 1);


SELECT id, email, domain, type, confidence, sources, first_name, last_name, "position", linkedin, twitter, phone_number, webmail, pattern, organization, e.category_id, ct.description
	FROM public.emails as e
    inner join categories as ct on e.category_id = ct.category_id
    where e.category_id = 272
  ï»¿ order by e.email
    limit 69240;

select case  when opened_user_agent like '%iPhone%' then 'iPhone'
            when opened_user_agent like '%iPad%' then 'iPad'
            when opened_user_agent like '%Macintosh%' then 'Mac'
            when opened_user_agent like '%Android%' then 'Android'
            when opened_user_agent like '%Android%' then 'Android'
            when opened_user_agent like '%GoogleImageProxy%' then 'GoogleImageProxy'
            when opened_user_agent like '%Mozilla/5.0 (Windows NT%' then 'Mozilla/5.0 (Windows NT)'
            when opened_user_agent like '%Microsoft Outlook%' then 'Microsoft Outlook'
            when opened_user_agent like '%Mozilla/4.0 (compatible%' then 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident)'
            else opened_user_agent
          end   as user_agent_adj , count(*) from mail_mail_statistics
where (opened is not Null) and (opened_user_agent is not Null ) and mass_mailing_id in (205, 206)
group by user_agent_adj
order by count(*) desc;



select case  when user_agent_string like '%iPhone%' then 'iPhone'
            when user_agent_string like '%iPad%' then 'iPad'
            when user_agent_string like '%Macintosh%' then 'Mac'
            when user_agent_string like '%Android%' then 'Android'
            when user_agent_string like '%Android%' then 'Android'
            when user_agent_string like '%GoogleImageProxy%' then 'GoogleImageProxy'
            when user_agent_string like '%Mozilla/5.0 (Windows NT%' then 'Mozilla/5.0 (Windows NT)'
            when user_agent_string like '%Microsoft Outlook%' then 'Microsoft Outlook'
            when user_agent_string like '%Mozilla/4.0 (compatible%' then 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident)'
            else user_agent_string
          end   as user_agent_adj , count(*) from link_tracker_click
where user_agent_string is not Null and mass_mailing_id in (205, 206)
group by user_agent_adj
order by count(*) desc

